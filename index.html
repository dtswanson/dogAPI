<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Mr. Swanson's API Demo for Class</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: #f4f7f6; padding: 30px; }
        .container { max-width: 800px; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .img-panel { height: 300px; background: #eee; display: flex; align-items: center; justify-content: center; overflow: hidden; border-radius: 8px; margin: 15px 0; }
        .img-panel img { width: 100%; height: 100%; object-fit: cover; }
        .debug-row { margin-top: 20px; display: flex; gap: 10px; }
        pre { background: #272822; color: #a6e22e; font-size: 11px; height: 150px; overflow-y: auto; }
        .label-api { color: #66d9ef; font-weight: bold; display: block; margin-bottom: 5px; }
    </style>
</head>
<body>

<div class="container text-center">
    <h2>Mr. Swanson's Multi-API Integration Demo</h2>
    <p>This demo calls two different servers and waits for both to respond.</p>
    
    <button class="btn btn-primary btn-lg get-dog">Fetch Dog Data</button>

    <div class="row">
        <div class="col-md-6">
            <div class="img-panel" id="dog-target">
                <span class="text-muted">Image will load here</span>
            </div>
        </div>
        <div class="col-md-6">
            <div class="well text-left" style="height: 300px; overflow-y: auto; margin-top: 15px;">
                <h4>Dog Fact</h4>
                <p id="fact-target">Click the button to fetch a fact.</p>
            </div>
        </div>
    </div>

    <div class="row text-left">
        <div class="col-md-6">
            <span class="label-api">API 1: Dog CEO (Image)</span>
            <pre id="debug-1">Waiting...</pre>
        </div>
        <div class="col-md-6">
            <span class="label-api">API 2: Dog Facts</span>
            <pre id="debug-2">Waiting...</pre>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script>
    $('.get-dog').click(function() {
        const btn = $(this);
        
        // 1. Set Loading UI
        btn.text("Loading...").prop("disabled", true);
        $("#fact-target").text("Fetching new facts...");
        $("#debug-1, #debug-2").text("Requesting...");

        // 2. Define API calls
        // Note: Using 'dogapi.dog' v2 for facts
        const call1 = $.getJSON("https://dog.ceo/api/breeds/image/random");
        const call2 = $.getJSON("https://dogapi.dog/api/v2/facts");

        // 3. Wait for both (The "Parallel" Fetch)
        $.when(call1, call2).done(function(res1, res2) {
            
            // --- API 1: Image Logic ---
            // res1 is [data, status, xhr]
            const dogData = res1[0]; 
            $("#dog-target").html(`<img src="${dogData.message}">`);
            $("#debug-1").text(JSON.stringify(dogData, null, 2));

            // --- API 2: Fact Logic ---
            // res2 is [data, status, xhr]
            const factData = res2[0];
            const actualFact = factData.data[0].attributes.body;
            $("#fact-target").html(`<strong>Did you know?</strong><br>${actualFact}`);
            $("#debug-2").text(JSON.stringify(factData, null, 2));

        }).fail(function(err) {
            $("#fact-target").text("Error: One of the APIs failed to respond.");
            console.error("API Failure", err);
        }).always(function() {
            // 4. Reset Button
            btn.text("Fetch Dog Data").prop("disabled", false);
        });
    });
</script>

</body>
</html>
